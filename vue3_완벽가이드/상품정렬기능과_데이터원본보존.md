# 상품정렬기능과 데이터 원본 보존

버튼을 누르면 상품이 가격순으로 정렬되어 보이는 기능을 만들어봅시다. 

버튼을 누르면 상품이 정렬되어서 보여야하는데 그럼 코드를 어떻게 짜야겠습니까. 

하단에 있는 원룸들이라는 데이터가 있는데 그걸 가격순으로 정렬만 하면 됩니다. 

원룸들이라는 데이터는 [ {}, {}, {}, {}, {}, {} ] 이렇게 생겼습니다.

{} 안에 각각 상품 정보들이 들어있고요. 이걸 가격순으로 정리하면 개발 끝입니다.

 

HTML은 어떻게 보일지 신경쓸 필요가 없습니다. 데이터를 정렬만 하면 알아서 바뀝니다.

{{데이터바인딩}}을 잘 해두셨으면 데이터가 변경사항이 생길시 HTML에도 자동으로 실시간 반영된다고 했으니까요. 

<br/>

## 정렬버튼 만들고 기능을 부여해봅시다

App.vue에 버튼 하나 만들고 기능을 만들어봅시다.

```html
<button @click="priceSort()" >가격순정렬</button>
```
```js
methods : {
  priceSort(){
    this.원룸들.sort()
  }
}
```
이런 식으로 코드를 짜면 가격순 정렬을 구현할 수 있을 듯 한데

잠깐 자바스크립트 .sort() 함수에 대해 설명드리자면 

```js
var array = [2,5,1];
array.sort();
```
이렇게 쓰면 array 자료가 가나다 순으로 정렬됩니다.

```js
var array = [2,5,1];
array.sort(function(a,b){
  return a - b
});
```
이렇게 쓰면 array 자료가 숫자 123 순으로 정렬됩니다.

왜냐면 a와 b라는 파라미터는 array 안에 있던 하나하나의 자료를 뜻한다고 보면 됩니다. 2랑 5 이런겁니다.

그리고 return 오른쪽에 있는 값이 - 음수면 a를 왼쪽, 

+ 양수면 a를 오른쪽으로 보내줍니다.

그런 원리로 sort 라는 함수가 동작하기 때문에 함수 안에 저렇게 코드를 이상하게 짜놓으면 숫자 123 순으로 정렬이 되는 것입니다. 오름차순 정렬이요. 

321 순으로 내림차순 정렬하려면 코드 어떻게 짜야하게요? 알아서 할 수 있겠죠? 

<br/>

그럼 우리 프로젝트로 돌아가서 
```html
<button @click="priceSort()" >가격순정렬</button>
```
```js
methods : {
  priceSort(){
    this.원룸들.sort(function(a,b){
      return a - b
    })
  }
}
```
this.원룸들이라는 자료는 어떻게 sort() 함수를 써야 가격순으로 정렬이 될까요.

원룸들이라는 자료는 [ {}, {}, {}, {}, {}, {} ] 이렇게 생겼습니다.

{} 안에 상품 하나의 이름, 가격 이런 것들이 잔뜩 들어있고요.

그래서 대충 return a - b 라고 기입하시면 안됩니다. 

{} - {} 해봤자 음수든 양수든 아무것도 안나오기 때문입니다.

음수나 양수가 나오도록 return 오른쪽을 잘 개발해보시길 바랍니다.

<br/>

## 순서 원래대로 되돌리기 버튼 만들고 기능을 부여해봅시다

App.vue에 원래대로 되돌리는 버튼도 추가하고 싶은 겁니다.

```html
<button @click="sortBack()" >되돌리기</button>
```
```js
methods : {
  sortBack(){
    ???
  }
}
```
누르면 원래 순서대로 돌아와야하는데 이거 코드 어떻게 짜면 되는거죠?

방법은 여러개인데 일단 사본을 만들어서 원본을 보존하는 방법도 좋은 방법입니다.

포토샵으로 사진보정할 때도 사본 하나를 만들어서 보정하지 않습니까.

그래서 원룸들 data를 똑같은걸 두개 만들어두는 겁니다.

```js
data(){
  return {
    원룸들오리지널 : data,
    원룸들 : data
  }
}
methods : { 
  sortBack(){ 
    this.원룸들 = this.원룸들오리지널
  } 
}
```
그래서 오리지널 원본을 똑같이 하나 만들어두고

되돌리기 버튼을 누르면 오리지널 원본을 가져와서 저기 집어넣는겁니다. 그럼 되겠네요

실은 안됩니다.

 

왜냐면 array나 object에다가 = 등호로 뭔가를 집어넣으시면

등호 왼쪽 오른쪽에 있는 array/object는 서로 값을 공유해주세요~ 라는 뜻이기 때문입니다. 

왜 그런지는 reference data type을 찾아보도록 합시다. 

그래서 아무튼 저렇게 sortBack()을 디자인해놓으면 안된다는 소리입니다. 

<br/>

```js
data(){
  return {
    원룸들오리지널 : [...data],
    원룸들 : [...data]
  }
}
methods : { 
  sortBack(){ 
    this.원룸들 = [...this.원룸들오리지널]
  } 
}
```

그래서 우리가 array 자료를 복사하거나

아니면 값공유가 일어나지 않게 집어넣고 싶으면 

[...array자료] 이렇게 사용합니다.

그래서 저렇게 온갖 곳에 다 사용해봤습니다.

그러면 안전하게 원본 array를 집어넣을 수 있습니다. 되돌리기 버튼 잘 동작할 듯요 

<br/>

### 점 3개... 문법에 대한 내용

가끔 자료의 사본을 만들고 싶을 때가 있습니다. 

가장 쉽게 복사할 수 있는 방법이 등호를 사용하는 겁니다.

예를 들면 a에 있던 자료를 b로 복사하고 싶으면 

```js
var a = '안녕하세요';
var b = a;
```
이렇게 등호를 사용합니다. 

등호는 오른쪽에 있던걸 대입하라는 뜻이니까요. 그럼 a와 b는 둘다 안녕하세요가 되겠네요.

근데 array,object 자료를 등호로 복사하면 큰일납니다. 

```js
var a = [1,2,3];
var b = a;
```
이렇게 등호를 사용하면 자료의 사본을 만들어주라는 뜻이 아닙니다. 

a와 b가 [1,2,3] 이걸 공유하라는 뜻입니다. 

그니까 이제 b를 수정하면 a에도 변경사항이 반영됩니다. 

object도 저렇게 복사하면 똑같은 현상이 일어납니다. 

<br/>

그래서 강의에서처럼 this.원룸들 = this.원룸들오리지널 이런거 하시면

"오리지널데이터를 저기 집어넣어라~"라는 뜻이 아니라 

"원룸들 & 원룸들오리지널은 서로 값을 똑같이 공유해주세요~" 라는 뜻입니다. 

그래서 이 상태에서 원룸들.sort()를 하시면 원룸들도 정렬되고 원룸들오리지널도 정렬됩니다. 

그래서 오리지널 데이터를 제대로 보존할 수 없습니다. 

<br/>

그래서 값공유가 일어나지않게 독립적인 array 복사본을 만들고 싶으면 

```js
var a = [1,2,3];
var b = [...a];
```

이렇게 하시면 됩니다. 

 

. . . 이 기호는 spread operator 라는 신기한 문법인데 

array나 object 앞에 붙일 수 있으며 

array, object의 괄호를 제거해주는 문법입니다. 

그래서 . . . [1,2,3] 이런 식으로 쓰면 1,2,3만 남는다는 소리입니다. 

 

그래서 약간의 트릭인데 array를 복사할 때 spread operator 이걸로 괄호를 벗겼다가 다시 씌우면 

그런 값공유 현상이 일어나지않게 복사할 수 있습니다. 

array를 해체했다가 다시 array로 만들면 서로 값 공유하지않는 별개의 사본을 만들 수 있어서 그렇습니다.

일종의 편법입니다.

왜 그냥 복사하면 값공유가 일어나는지는 심심하면 reference data type 을 찾아보도록 합시다. 